<link rel="import" href="../../components/polymer/polymer.html">

<dom-module id="child-element">
  <template>
    <style>
      :host {
        display: block;
      }
      
      paper-button {
        text-transform: none;
      }
      
      pre {
        font-family: ui-monospace, monospace;
        margin: 0;
      }
    </style>
    
    <paper-button on-click="_whoami">Whoami</paper-button>
    <paper-button on-click="_createPaper">Create Paper</paper-button>
    <div class="status">[[status]]</div>
  </template>

  <script>
    Polymer({
      is: 'child-element',
      
      properties: {
        status: {
          type: String,
          value: ''
        },
        api: Object
      },
      
      _whoami: function() {
        this.status = 'Checking user...';
        this.api(this).user()
          .then(response => {
            this.status = `User: ${response.name || response.email}`;
          })
          .catch(error => {
            this.status = `Error: ${error.message}`;
          });
      },
      
      _createPaper: function() {
        this.status = 'Creating paper...';
        const paperData = {
          name: `Test Paper ${new Date().toISOString()}`,
          type: 'whiteboard'
        };
        this.api(this).paper.create(paperData)
          .then(response => {
            this.status = `Created: ${response.id}`;
          })
          .catch(error => {
            this.status = `Error: ${error.message}`;
          });
      }
    });
  </script>
</dom-module>
